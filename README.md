# PanHouse Slide Editor

最終更新: 2025-12-03
タグ: #product #スライドエディタ #内製ツール

## コンセプト

**「JSONを渡せば、編集可能なスライドがブラウザで開く」**

GASスライドジェネレーターの手軽さと、wills_ph3エディタの自由度を両立した汎用スライドエディタ。

## ユースケース

| 用途 | 説明 |
|------|------|
| 提案書 | 顧客向け提案資料 |
| 進捗報告 | プロジェクト進捗MTG用 |
| 研修資料 | AI研修のスライド |
| 統合報告書 | wills_ph3の機能を継承 |

## 設計方針

### 1. 入力：JSON定義
```json
{
  "settings": {
    "title": "提案書",
    "theme": "panhouse",
    "aspectRatio": "16:9"
  },
  "slides": [
    {
      "type": "title",
      "title": "AI研修のご提案",
      "subtitle": "株式会社パンハウス"
    },
    {
      "type": "content",
      "title": "本日のアジェンダ",
      "items": ["項目1", "項目2", "項目3"]
    }
  ]
}
```

### 2. 処理：Webエディタ
- JSONを読み込んで自動レンダリング
- ドラッグ&ドロップで自由編集
- 画像はローカルからアップロード可能
- リアルタイムプレビュー

### 3. 出力：複数形式
- PDF（印刷用）
- PPTX（PowerPoint）
- HTML（Web共有）
- JSON（再編集用）

## アーキテクチャ

```
┌─────────────────────────────────────────────────┐
│                  Slide Editor                    │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐   │
│  │ ページ一覧 │  │  キャンバス │  │ プロパティ │   │
│  │ (左サイド) │  │  (中央)    │  │ (右サイド) │   │
│  └───────────┘  └───────────┘  └───────────┘   │
└─────────────────────────────────────────────────┘
         ↑                              ↓
    JSON入力                      PDF/PPTX/HTML出力
```

## フォルダ構成

```
slide/
├── README.md           # このファイル
├── index.html          # エディタ本体
├── css/
│   ├── editor.css      # エディタUI
│   └── themes/         # カラーテーマ
│       ├── panhouse.css
│       ├── blue.css
│       └── minimal.css
├── js/
│   ├── editor.js       # エディタコア
│   ├── renderer.js     # スライドレンダリング
│   ├── exporter.js     # エクスポート機能
│   └── templates.js    # スライドテンプレート
├── templates/          # スライドタイプ定義
│   ├── title.html
│   ├── content.html
│   ├── table.html
│   ├── compare.html
│   ├── timeline.html
│   └── ...
├── samples/            # サンプルJSON
│   ├── proposal.json   # 提案書サンプル
│   ├── progress.json   # 進捗報告サンプル
│   └── training.json   # 研修資料サンプル
└── docs/
    └── SLIDE_TYPES.md  # スライドタイプ仕様
```

## スライドタイプ（予定）

### 基本タイプ
| タイプ | 用途 |
|--------|------|
| `title` | タイトルスライド |
| `agenda` | アジェンダ・目次 |
| `section` | セクション区切り |
| `content` | 箇条書きコンテンツ |
| `closing` | クロージング |

### コンテンツタイプ
| タイプ | 用途 |
|--------|------|
| `table` | テーブル表示 |
| `compare` | 比較（左右） |
| `cards` | カード形式 |
| `timeline` | タイムライン |
| `imageText` | 画像+テキスト |
| `chart` | グラフ（Chart.js） |

### 特殊タイプ（統合報告書向け）
| タイプ | 用途 |
|--------|------|
| `kpi` | KPIダッシュボード |
| `riskMatrix` | リスクマトリックス |
| `valueCreation` | 価値創造ストーリー |
| `governance` | ガバナンス構成 |

## 開発ステップ

1. [ ] コアエディタ実装（HTML/CSS/JS）
2. [ ] 基本スライドタイプ実装
3. [ ] JSON読み込み・レンダリング
4. [ ] ドラッグ&ドロップ編集
5. [ ] 画像アップロード機能
6. [ ] PDFエクスポート
7. [ ] PPTXエクスポート
8. [ ] テーマ切り替え
9. [ ] wills_ph3のコンポーネント移植

## スライド生成ルール（Claude Code用）

### 基本原則

1. **スライドタイプを多様に使う**
   - 箇条書き（`content`）だけに偏らない
   - 内容に応じて適切なタイプを選択する

2. **スピーカーノートを必ず付ける**
   - 各スライドに `notes` フィールドを追加
   - スライド本文は簡潔に、詳細はノートで補足
   - 「なぜ」「背景」「補足情報」をノートに記載

3. **情報の粒度**
   - スライド本文: 3〜6項目程度
   - 詳細な説明はスピーカーノートへ

### スライドタイプの使い分け

| 内容 | 推奨タイプ | 例 |
|------|-----------|-----|
| 数値・金額 | `kpi` | 費用、KPI、統計 |
| ステップ・フロー | `process` | 契約プロセス、手順 |
| 対比・二項 | `compare` | メリット/デメリット、遵守/禁止 |
| 詳細データ | `table` | 料金表、一覧 |
| 要点強調 | `quote` | 重要な定義、統計ハイライト |
| カテゴリ別 | `icon-cards` | サービス一覧、特典 |
| 時系列 | `roadmap` / `timeline` | スケジュール、マイルストーン |
| 優先度判断 | `matrix` | 2x2マトリクス |
| 箇条書き | `content` | 上記に当てはまらない場合 |

### compareタイプの注意点

**正しい形式**（leftTitle/leftItems形式）:
```json
{
  "type": "compare",
  "title": "甲の義務",
  "leftTitle": "✅ 遵守事項",
  "leftItems": ["項目1", "項目2"],
  "rightTitle": "🚫 禁止事項",
  "rightItems": ["項目A", "項目B"]
}
```

**間違い**（columns形式は使わない）:
```json
{
  "type": "compare",
  "columns": [...]  // これは動作しない
}
```

### スピーカーノートの書き方

```json
{
  "type": "kpi",
  "title": "初期費用",
  "metrics": [...],
  "notes": "【重要ポイント】加盟金190万円は返金不可です。たとえ1ヶ月で退会しても返金されません。この金額はペナルティの基準額にもなっています（後述）。"
}
```

**ノートに含めるべき内容**:
- 補足説明（スライドに書ききれない詳細）
- 背景情報（なぜこうなっているか）
- 具体例・計算例
- 注意点・警告
- 話す際のポイント

### 生成時のチェックリスト

- [ ] スライドタイプは3種類以上使っているか？
- [ ] 全スライドにスピーカーノートがあるか？
- [ ] 数値情報には `kpi` または `table` を使っているか？
- [ ] 対比情報には `compare` を使っているか？
- [ ] `compare` は正しい形式（leftTitle/leftItems）か？

## 参考

- wills_ph3エディタ: `project/dev/01_顧客/03_wills_ph3/editor/`
- GASスライドジェネレーター: `scripts/slide_generator/`
