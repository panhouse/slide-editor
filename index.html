<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PanHouse Slide Editor</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="css/editor.css?v=12">
  <link rel="stylesheet" href="css/slide.css?v=10">
  <link rel="stylesheet" href="css/themes/panhouse.css">
  <link rel="stylesheet" href="css/themes/consulting.css?v=9">
  <link rel="stylesheet" href="css/themes/integrated-report.css?v=3">
  <!-- Google Fonts for Consulting Theme -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
</head>
<body>
  <div class="app">
    <!-- ヘッダー -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <span class="logo-icon">▶</span>
          <span class="logo-text">Slide Editor</span>
        </div>

        <!-- ファイル操作 -->
        <div class="file-actions">
          <button class="btn btn-icon" id="openJsonBtn" title="JSONを開く (Ctrl+O)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="12" y1="18" x2="12" y2="12"/>
              <line x1="9" y1="15" x2="15" y2="15"/>
            </svg>
            <span>開く (JSON)</span>
          </button>
        </div>

        <!-- Undo/Redo -->
        <div class="history-actions">
          <button class="btn btn-icon" id="undoBtn" title="元に戻す (Ctrl+Z)" disabled>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 14L4 9l5-5"/>
              <path d="M4 9h11a4 4 0 0 1 0 8h-1"/>
            </svg>
          </button>
          <button class="btn btn-icon" id="redoBtn" title="やり直し (Ctrl+Y)" disabled>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 14l5-5-5-5"/>
              <path d="M20 9H9a4 4 0 0 0 0 8h1"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="header-center">
        <div class="toolbar">
          <button class="tool-btn active" data-tool="select" title="選択 (V)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="text" title="テキスト (T)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="image" title="画像 (I)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="header-right">
        <!-- テーマ選択 -->
        <select id="themeSelect" class="theme-select">
          <option value="panhouse">PanHouse</option>
          <option value="consulting">Consulting</option>
          <option value="integrated-report">統合報告書</option>
        </select>

        <!-- エクスポート -->
        <div class="dropdown">
          <button class="btn btn-primary" id="exportBtn">
            エクスポート
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <div class="dropdown-menu" id="exportMenu">
            <button class="dropdown-item" data-format="pdf">PDF形式</button>
            <button class="dropdown-item" data-format="pptx">PowerPoint形式</button>
            <button class="dropdown-item" data-format="html">HTML形式</button>
            <button class="dropdown-item" data-format="json">JSON形式</button>
          </div>
        </div>

        <!-- 隠しファイル入力 -->
        <input type="file" id="jsonFileInput" accept=".json" style="display: none;">
      </div>
    </header>

    <!-- メインコンテンツ -->
    <div class="main">
      <!-- 左サイドバー: ページ一覧 -->
      <aside class="sidebar sidebar-left" id="sidebarLeft">
        <div class="sidebar-resize-handle" id="sidebarResizeHandle"></div>
        <div class="sidebar-header">
          <span>ページ</span>
          <button class="btn-icon" id="addPageBtn" title="ページ追加">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div class="page-list" id="pageList">
          <!-- ページサムネイルがここに入る -->
        </div>
      </aside>

      <!-- キャンバスエリア -->
      <main class="canvas-area">
        <div class="canvas-wrapper">
          <div class="canvas-container" id="canvasContainer">
            <div class="slide-canvas" id="slideCanvas">
              <!-- スライドがここにレンダリングされる -->
            </div>
          </div>
        </div>

        <!-- ズームコントロール -->
        <div class="zoom-controls">
          <button class="zoom-btn" id="zoomOutBtn">−</button>
          <span class="zoom-level" id="zoomLevel">100%</span>
          <button class="zoom-btn" id="zoomInBtn">+</button>
        </div>

        <!-- スピーカーノート（下部） -->
        <div class="speaker-notes-panel" id="speakerNotesPanel">
          <div class="speaker-notes-resize-handle" id="speakerNotesResizeHandle"></div>
          <textarea class="speaker-notes-input" id="speakerNotesInput" placeholder="スピーカーノートを入力..."></textarea>
        </div>
      </main>
    </div>

    <!-- フッター -->
    <footer class="footer">
      <div class="footer-left">
        <span id="slideInfo">ページ 1 / 1</span>
      </div>
      <div class="footer-right">
        <span class="footer-hint">Ctrl+S: 保存 | Ctrl+E: エクスポート</span>
      </div>
    </footer>
  </div>

  <!-- テキスト編集ツールバー -->
  <div class="text-toolbar" id="textToolbar" style="display: none;">
    <select id="textFontSize" title="フォントサイズ">
      <option value="12">12px</option>
      <option value="14">14px</option>
      <option value="16" selected>16px</option>
      <option value="18">18px</option>
      <option value="20">20px</option>
      <option value="24">24px</option>
      <option value="28">28px</option>
      <option value="32">32px</option>
      <option value="36">36px</option>
      <option value="48">48px</option>
      <option value="64">64px</option>
    </select>
    <button class="text-toolbar-btn" id="textBold" title="太字">
      <strong>B</strong>
    </button>
    <input type="color" id="textColor" value="#333333" title="文字色">
  </div>

  <!-- JSON入力モーダル -->
  <div class="modal" id="jsonModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>JSONを入力</h3>
        <button class="modal-close" id="jsonModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <textarea id="jsonInput" placeholder='{"slides": [{"type": "title", "title": "タイトル"}]}'></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="jsonModalCancel">キャンセル</button>
        <button class="btn btn-primary" id="jsonModalLoad">読み込む</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/core/Utils.js?v=3"></script>
  <script src="js/core/EventBus.js?v=3"></script>
  <script src="js/core/SlideManager.js?v=9"></script>
  <script src="js/core/JsonParser.js?v=9"></script>
  <script src="js/renderer/types/BaseRenderer.js?v=8"></script>
  <script src="js/renderer/types/TitleRenderer.js?v=5"></script>
  <script src="js/renderer/types/ContentRenderer.js?v=6"></script>
  <script src="js/renderer/types/TableRenderer.js?v=5"></script>
  <script src="js/renderer/types/CompareRenderer.js?v=4"></script>
  <script src="js/renderer/types/CardsRenderer.js?v=4"></script>
  <script src="js/renderer/types/TimelineRenderer.js?v=4"></script>
  <script src="js/renderer/types/ImageRenderer.js?v=4"></script>
  <script src="js/renderer/types/TextRenderer.js?v=4"></script>
  <!-- Rich Components -->
  <script src="js/renderer/types/ProcessRenderer.js?v=1"></script>
  <script src="js/renderer/types/MatrixRenderer.js?v=1"></script>
  <script src="js/renderer/types/KpiRenderer.js?v=2"></script>
  <script src="js/renderer/types/RoadmapRenderer.js?v=1"></script>
  <script src="js/renderer/types/QuoteRenderer.js?v=1"></script>
  <script src="js/renderer/types/IconCardsRenderer.js?v=2"></script>
  <!-- Integrated Report Components -->
  <script src="js/renderer/types/PhilosophyRenderer.js?v=2"></script>
  <script src="js/renderer/types/CeoMessageRenderer.js?v=2"></script>
  <script src="js/renderer/types/BusinessModelRenderer.js?v=2"></script>
  <script src="js/renderer/SlideRenderer.js?v=14"></script>
  <script src="js/themes/ThemeManager.js?v=5"></script>
  <script src="js/editor/PageList.js?v=5"></script>
  <script src="js/editor/Properties.js?v=4"></script>
  <script src="js/editor/Canvas.js?v=7"></script>
  <script src="js/editor/ImageUploader.js?v=3"></script>
  <script src="js/editor/ElementEditor.js?v=3"></script>
  <script src="js/editor/DragDropEditor.js?v=14"></script>
  <script src="js/editor/ResizeHandler.js?v=2"></script>
  <script src="js/editor/Editor.js?v=16"></script>
  <script src="js/export/PdfExporter.js?v=6"></script>
  <script src="js/export/PptxExporter.js?v=1"></script>
  <script src="js/export/HtmlExporter.js?v=1"></script>
  <script src="js/app.js?v=4"></script>
</body>
</html>
